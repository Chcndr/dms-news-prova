<!DOCTYPE html>
<html lang="it">
<head>
<meta charset
<base href="/dms-gemello-news/">="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DMS ¬∑ Gemello Digitale ‚Äî Spot & Documenti</title>
<meta name="color-scheme" content="dark">
<style>
  :root{ --bgA:#0e2d38; --bgB:#155268; --ink:#dde2e4; --accent:#46a0bd; --r:14px; }
  *{box-sizing:border-box}
  body{
    margin:0; color:var(--ink);
    background: radial-gradient(1000px 700px at 60% 18%, #1a566b 0%, transparent 60%),
                linear-gradient(180deg, var(--bgB), var(--bgA));
    font:16px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  .top{display:flex; gap:10px; padding:18px}
  .btn{
    appearance:none; border:2px solid rgba(255,255,255,.2);
    background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
    color:var(--ink); padding:.55rem .9rem; border-radius:12px; font-weight:700;
    backdrop-filter:blur(6px); text-decoration:none; cursor:pointer;
  }
  .wrap{display:grid; grid-template-columns: minmax(260px, 520px) 1fr; gap:18px; padding:0 18px 28px}
  .panel{background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.18); border-radius:16px; padding:14px}
  h2{margin:6px 6px 12px 6px}
  h3.section-title{
    margin:20px 6px 8px 6px; 
    color:#14b8a6; 
    font-size:14px; 
    font-weight:600; 
    text-transform:uppercase; 
    letter-spacing:0.5px;
    border-bottom:1px solid rgba(20,184,166,.3);
    padding-bottom:4px;
  }
  .doc{display:flex; align-items:center; justify-content:space-between; gap:8px;
       border:1px solid rgba(255,255,255,.2); border-radius:12px; padding:.7rem 1rem;
       margin:10px 6px; background:rgba(255,255,255,.05); text-decoration:none; color:var(--ink)}
  .doc:hover{background:rgba(255,255,255,.08)}
  .videos{display:flex; flex-direction:column; gap:14px}
  video{width:100%; border-radius:12px; border:1px solid rgba(255,255,255,.18); display:block}
  @media (max-width:900px){ .wrap{grid-template-columns: 1fr} }
</style>
<link rel="stylesheet" href="./assets/theme-green.css">
<style>
:root{--blue:#2A8CFF;--line:#1c2c26;--g1:#145e49;--g2:#0f4b3a}
  background:linear-gradient(180deg,var(--g1) 0%,var(--g2) 100%);color:#fff;text-decoration:none;
  border:1px solid var(--line);border-radius:14px;font-weight:800}
.arts{border-left:3px solid var(--blue);padding-left:10px;margin:10px 0}
.btn{display:inline-flex;gap:8px;padding:8px 12px;border:1px solid var(--blue);border-radius:10px;text-decoration:none;font-weight:800}
</style>
<style>
    display:flex;align-items:center;justify-content:center;min-height:48px;
    background:linear-gradient(180deg,#145e49 0%,#0f4b3a 100%);
    color:#fff;text-decoration:none;border:1px solid #1c2c26;border-radius:14px;font-weight:800
  }
    box-shadow:0 0 0 2px #2A8CFF, inset 0 0 0 1px #2A8CFF
  }
    background:#fff;color:#0b0f14;border:1px solid #dfe7e2;border-radius:14px;
    padding:16px;margin-top:12px;box-shadow:0 8px 24px rgba(0,0,0,.12)
  }
                 border-radius:10px;text-decoration:none;font-weight:800}
</style>
<!-- THEME GREEN OVERRIDE (safe, removable) -->
<style id="theme-green">
  :root{
    /* Fondo: verde scuro elegante */
    --bg-a:#071a1d;
    --bg-b:#0b2730;
    /* Testi */
    --ink:#e8fbff;
    --muted:#9bd6de;
    /* Pannelli e bordi */
    --panel:rgba(7,26,29,.78);
    --stroke:rgba(173,234,240,.18);
    /* Accenti */
    --accent:#14b8a6;
    --accent2:#0b5fff;
    /* Gradiente di sfondo */
    --bg-gradient:radial-gradient(1000px 700px at 60% 18%, #0f4c3a 0%, transparent 60%),
                  linear-gradient(180deg, var(--bg-b), var(--bg-a));
  }
  body{
    background:var(--bg-gradient);
    color:var(--ink);
  }
  .panel{
    background:var(--panel);
    border-color:var(--stroke);
    backdrop-filter:blur(8px);
  }
  .btn{
    border-color:var(--stroke);
    background:linear-gradient(180deg, rgba(20,184,166,.15), rgba(20,184,166,.08));
    color:var(--ink);
  }
  .btn:hover{
    background:linear-gradient(180deg, rgba(20,184,166,.25), rgba(20,184,166,.15));
  }
  .doc{
    border-color:var(--stroke);
    background:rgba(20,184,166,.08);
  }
  .doc:hover{
    background:rgba(20,184,166,.15);
  }
  
  /* Evidenziazione rossa per pulsanti "hot" */
  .btn.is-hot, a.is-hot {
    outline: 3px solid #e11d48;
    box-shadow: 0 0 0 4px rgba(225,29,72,.25);
    border-radius: 10px;
  }

  :root{
    /* IDENTICO al bottone PDF */
    --spot-chip-bg: #0f766e;       /* stesso verde dei PDF */
    --spot-chip-bg-hover: #115e59; /* hover pi√π scuro */
    --spot-chip-text: #e6fff7;
    --spot-chip-border-active: #22d3ee; /* ciano per attivate (pertinenti) */
  }

  /* griglia: 1 col mobile, 2 col tablet, 3 col desktop */
  /* === PATCH ULTRA-SEMPLICE: 2 colonne, verde identico PDF === */
  :root{
    --chip-bg: #0f766e;          /* verr√† sovrascritto via JS col colore reale dei PDF */
    --chip-bg-hover:#115e59;
    --chip-text:#e6fff7;
    --chip-border-active:#22d3ee; /* ciano */
  }

  .norme-grid{
    display:grid;
    grid-template-columns: repeat(2, minmax(0,1fr)); /* 2 colonne fisse */
    gap:12px;
  }

  .norma-chip{
    display:inline-flex; align-items:center; justify-content:center;
    width:100%; min-height:44px; padding:10px 14px;
    border-radius:10px;
    background:var(--chip-bg);
    color:var(--chip-text);
    border:2px solid transparent;               /* niente bordo di base */
    text-decoration:none; font-weight:600;
    line-height:1.25; white-space:normal;
    word-break:break-word; hyphens:auto;
    font-size:clamp(12px, 1.6vw, 16px);         /* le etichette lunghe non esplodono */
  }
  .norma-chip:hover,.norma-chip:focus{ background:var(--chip-bg-hover); }
  .norma-chip.is-active{ border-color:var(--chip-border-active); }

  /* Scheda normativa (quadra, bianca) */
    background:#ffffff; color:#0b0f14;
    border:1px solid #dfe7e2; border-radius:14px;
    padding:16px; margin-top:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.12);
    grid-column: 1 / -1; /* occupa tutta la larghezza della griglia */
  }

  /* Stato "vuota" (placeholder) */
  .norma-empty{ display:flex; align-items:center; justify-content:center; min-height:140px; font-weight:700; color:#6b7d72 }
</style>
</head>
<body>
  <nav class="top">
    <a href="/dms-gemello-news/landing/home.html" class="btn">Home</a>
    <a href="/dms-gemello-news/landing/mappa-ministeri.html" class="btn">Mappa</a>
    <a href="/dms-gemello-news/landing/spot.html" class="btn">Spot</a>
  </nav>

  <div class="wrap">
    <section class="panel">
      <h2>Documenti (PDF)</h2>
      <p style="margin:6px 6px 16px; color:#9bd6de; font-size:14px">
        Archivio completo della documentazione DMS organizzato per categorie
      </p>
      <div id="docs">
        <!-- I documenti verranno inseriti qui via JavaScript -->
      </div>
    </section>

    <section class="panel">
      <section class="videos">
        <h2>Video</h2>
        
        <div class="video-item">
          <h3>Riaccendiamo i mercati</h3>
          <video controls preload="metadata" playsinline muted width="100%" poster="/dms-gemello-news/assets/poster-riaccendiamo.jpg">
            <source src="/dms-gemello-news/landing/videos/teaser-riaccendiamo.mp4?v=20250905a" type="video/mp4">
          </video>
        </div>

        <div class="video-item">
          <h3>Hub Emilia Romagna</h3>
          <video controls preload="metadata" playsinline muted width="100%" poster="/dms-gemello-news/assets/poster-emilia-romagna.jpg">
            <source src="/dms-gemello-news/landing/videos/teaser-emilia-romagna.mp4?v=20250905a" type="video/mp4">
          </video>
        </div>

        <div class="video-item">
          <h3>Futuro (Filmato 23)</h3>
          <video controls preload="metadata" playsinline muted width="100%" poster="/dms-gemello-news/assets/poster-futuro.jpg">
            <source src="/dms-gemello-news/landing/videos/teaser-23.mp4?v=20250905a" type="video/mp4">
          </video>
        </div>
      </section>

      <!-- ancora per scroll stabile -->
      <div id="goto-norme" style="position:relative;top:-80px;"></div>

        <h2 style="grid-column: 1 / -1;">Riferimenti normativi & PNRR</h2>
            Single Digital Gateway (Reg. UE 2018/1724)
          </a>
            Interoperable Europe (Reg. UE 2024/903)
          </a>
            eIDAS 2 ‚Äì Digital Wallet (Reg. UE 2024/1183)
          </a>
            ESPR & Digital Product Passport (Reg. UE 2024/1781)
          </a>
            Direttiva Servizi (2006/123/CE ‚Äì "Bolkestein")
          </a>
            SUAP ‚Äì DPR 160/2010
          </a>
            Riforma Dogane UE (pacchetto COM(2023) 258‚Äì260)
          </a>
            PNRR ‚Äì Italia Domani
          </a>
            PDND ‚Äì Piattaforma Digitale Nazionale Dati
          </a>
            AgID ‚Äì Linee guida interoperabilit√†
          </a>
        </div>
      </section>
    </section>
  </div>

<script>
  // Lista PDF completa organizzata per sezioni
  const PDF_SECTIONS = [
    {
      title: "Documenti Base",
      docs: [
        ["Hub Nazionale del Commercio","/dms-gemello-news/assets/doc/HUBNAZIONALEDELCOMMERCIO(2).pdf"],
        ["DMS & CLUST-ER","/dms-gemello-news/assets/doc/DMSECLUST-ER(4).pdf"],
        ["Dossier Nazionale","/dms-gemello-news/assets/doc/DOSSIERNAZIONALE(3).pdf"],
        ["DMS - Riaccendiamo i Mercati, Rivitalizziamo le Citt√†","/dms-gemello-news/assets/doc/DMS-RiaccendiamoiMercati-RivitalizziamoleCitta.pdf"],
        ["Passaporto EU","/dms-gemello-news/assets/doc/PASSAPORTOEU(3).pdf"],
        ["Presentazione DMS (Bologna)","/dms-gemello-news/assets/doc/PRESENTAZIONEDMS-CITTAMETROPOLITANADIBOLOGNA-3.pdf"],
        ["Hub Urbani e di Prossimit√† in Emilia-Romagna","/dms-gemello-news/assets/doc/HubUrbaniediProssimita-EmiliaRomagna-1.pdf"],
        ["Gemello DMS","/dms-gemello-news/assets/doc/INFRASTRUTTURARETEDMSEUROPA.pdf"],
        ["DMS ECC (narrativo)","/dms-gemello-news/assets/doc/EQUILIBRIOECOSOSTENIBILE.pdf"],
        ["DMS ECC (tecnico)","/dms-gemello-news/assets/doc/DMSECC(3).pdf"],
        ["Carbon Credit ‚Äì Logica","/dms-gemello-news/assets/doc/LOGICACARBONCREDIT(3).pdf"],
        ["Carbon Credit DMS","/dms-gemello-news/assets/doc/CARBONCREDITDMS-4.pdf"],
        ["Ecosistema Costi PA","/dms-gemello-news/assets/doc/EcosistemaDMS-hub-costiPA-2.pdf"],
        ["Analisi & Soluzione DMS","/dms-gemello-news/assets/doc/ANALISIESOLUZIONEDMS(1).pdf"],
        ["Scenario Futuro","/dms-gemello-news/assets/doc/ScenarioFuturo(3).pdf"]
      ]
    },
    {
      title: "Analisi e Ricerche",
      docs: [
        ["Analisi Commercio Ambulante","/dms-gemello-news/assets/doc/Relazionecalocommercioambulante.pdf"],
        ["Report Controlli PA","/dms-gemello-news/assets/doc/Relazionesuicontrolli(1).pdf"],
        ["Analisi Dati Sistema","/dms-gemello-news/assets/doc/DATI.pdf"],
        ["Mercato dell'Usato","/dms-gemello-news/assets/doc/USATO.pdf"],
        ["Riequilibrio Economico","/dms-gemello-news/assets/doc/RIEQUILIBRIO.pdf"],
        ["Relazione Approfondita DMS (102 pagine)","/dms-gemello-news/assets/doc/ANALISIESOLUZIONEDMS(1).pdf"]
      ]
    },
    {
      title: "Implementazione Tecnica",
      docs: [
        ["DMS Sistema Completo","/dms-gemello-news/assets/doc/DMScompleto2(1).pdf"],
        ["Implementazioni Avanzate","/dms-gemello-news/assets/doc/IMPLEMENTAZIONI(1).pdf"],
        ["DMS Offline con CIE","/dms-gemello-news/assets/doc/DMSofflineconCIE(1).pdf"],
        ["Gestione Servizi Accessori","/dms-gemello-news/assets/doc/GESTIONESERVIZIACCESSORI(1).pdf"],
        ["DMS al Centro di Tutto","/dms-gemello-news/assets/doc/DMSalCENTROdiTUTTO(1).pdf"],
        ["Frammentazione Digitale PA","/dms-gemello-news/assets/doc/Vuoto1332(1).pdf"]
      ]
    },
    {
      title: "FinTech e Carbon Credit",
      docs: [
        ["DMS FinTech","/dms-gemello-news/assets/doc/DMSFINTECH.pdf"],
        ["Eco Carbon Credit","/dms-gemello-news/assets/doc/ECOCOCREDOIT.pdf"],
        ["Logica Carbon Credit Avanzata","/dms-gemello-news/assets/doc/LOGICACARBONCREDIT(3).pdf"],
        ["Eventi Straordinari","/dms-gemello-news/assets/doc/EVENTISTRAORDINARI(2).pdf"]
      ]
    },
    {
      title: "Progetto Nazionale",
      docs: [
        ["Progetto Nazionale","/dms-gemello-news/assets/doc/PROGETTONAZIONALE1(1).pdf"],
        ["Hub DMS Web3 Europa","/dms-gemello-news/assets/doc/DMSWeb3-SmartContract(2).pdf"],
        ["Premessa Politica","/dms-gemello-news/assets/doc/PREMESSAPOLITICA.pdf"],
        ["Bolkestein Commercio","/dms-gemello-news/assets/doc/BOLKESTEINCOMMERCIOSUAREAPUBBLICA.pdf"]
      ]
    },
    {
      title: "App e Strumenti",
      docs: [
        ["App DMS Assistente","/dms-gemello-news/assets/doc/APPDMSAssistentePersonale.pdf"],
        ["DMS Locandina","/dms-gemello-news/assets/doc/DMSLOCANDINA.pdf"],
        ["DMS Set v2","/dms-gemello-news/assets/doc/DMSSSET(2).pdf"]
      ]
    }
  ];

  // Genera la lista dei documenti organizzata per sezioni
  const list = document.getElementById('docs');
  
  PDF_SECTIONS.forEach(section => {
    // Aggiungi titolo sezione
    const sectionTitle = document.createElement('h3');
    sectionTitle.className = 'section-title';
    sectionTitle.textContent = section.title;
    list.appendChild(sectionTitle);
    
    // Aggiungi documenti della sezione
    section.docs.forEach(([title, href]) => {
      const a = document.createElement('a');
      a.className = 'doc';
      a.href = href;
      a.target = '_blank';
      a.rel = 'noopener';
      
      // Aggiungo data-doc per evidenziazione hash e data-spot + id per evidenziazione rossa
      const slug = title.toLowerCase().replace(/\s+/g,'-').replace(/[^\w-]/g,'');
      a.setAttribute('data-doc', slug);
      a.setAttribute('data-spot', slug);
      a.id = slug;
      a.innerHTML = `<span>${title}</span><span>Apri ‚§¥</span>`;
      list.appendChild(a);
    });
  });

  // Evidenziazione hash-based
  (function(){
    const h = (location.hash||'').replace('#','');
    if(!h) return;
    const btn = document.querySelector(`[data-doc="${h}"]`);
    if(btn){
      btn.classList.add('is-active');
      btn.scrollIntoView({behavior:'smooth',block:'center'});
    }
  })();

  // Evidenziazione rossa per pulsanti "hot" da parametri URL
  (function(){
    const q = new URLSearchParams(location.search);
    const raw = (q.get("hot")||"").split(",").map(s=>s.trim()).filter(Boolean);
    if (!raw.length) return;

    const norm = s => s.toLowerCase().replace(/\s+/g,'').replace(/[^\p{L}\p{N}]/gu,'');

    const pool = Array.from(document.querySelectorAll('a,button'))
      .filter(el => (el.href||'').includes('/assets/doc/') || el.dataset.spot);

    const byId = id => document.getElementById(id) ||
                       document.querySelector(`[data-spot="${id}"]`);

    const hot = new Set();
    raw.forEach(tok => {
      const t = norm(tok);
      let hit = false;

      // 1) prova id/data-spot
      const idHit = byId(tok);
      if (idHit) { hot.add(idHit); hit = true; }

      // 2) fallback: match per contenuto testuale
      if (!hit) {
        pool.forEach(el=>{
          const label = norm(el.textContent||"");
          if (label.includes(t)) hot.add(el);
        });
      }
    });

    // applica stile e rimuovi al click
    let first = null;
    hot.forEach(el=>{
      el.classList.add('is-hot');
      if (!first) first = el;
      el.addEventListener('click', ()=> el.classList.remove('is-hot'), {once:true});
    });
    if (first) first.scrollIntoView({behavior:'smooth', block:'start'});

  })();
</script>

<script>
// === PATCH SCHEDA NORMATIVA ===

// Dataset minimo (aggiungi/aggiorna i tuoi PDF)
  dpr160_2010:{
    titolo:'DPR 160/2010 ‚Äì SUAP',
    perche:'DMS genera pratiche conformi (SCIA, subingressi, volture) e orchestra endo-pareri.',
    articoli:[ {art:'art. 5', focus:'interoperabilit√† e telematica'}, {art:'art. 10', focus:'endo-pareri con enti terzi'} ],
    pdf:'https://www.gazzettaufficiale.it/eli/id/2010/10/29/010G0184/sg'
  },
  siconbep_106_2023:{
    titolo:'D.Lgs. 106/2023 ‚Äì SICONBEP',
    perche:'DMS alimenta automaticamente gli invii sulle concessioni/posteggi.',
    articoli:[ {art:'obblighi telematici', focus:'monitoraggio concessioni'} ],
    pdf:'https://www.gazzettaufficiale.it/eli/id/2023/05/31/23G00119/sg'
  },
  sdg_2018_1724:{
    titolo:'Reg. (UE) 2018/1724 ‚Äì Single Digital Gateway',
    perche:'Principio once-only: DMS riusa dati certificati via PDND.',
    articoli:[ {art:'artt. chiave', focus:'riuso dati cross-PA e servizi online'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32018R1724'
  },
  interop_2024_903:{
    titolo:'Reg. (UE) 2024/903 ‚Äì Interoperable Europe',
    perche:'Framework per interoperabilit√† cross-border: DMS implementa standard comuni.',
    articoli:[ {art:'art. 12', focus:'governance interoperabilit√†'}, {art:'art. 15', focus:'standard tecnici'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32024R0903'
  },
  eidas2_2024_1183:{
    titolo:'Reg. (UE) 2024/1183 ‚Äì eIDAS 2 Digital Wallet',
    perche:'DMS integra wallet digitale europeo per identit√† e credenziali verificabili.',
    articoli:[ {art:'art. 6a', focus:'wallet digitale europeo'}, {art:'art. 45a', focus:'credenziali verificabili'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32024R1183'
  },
  espr_2024_1781:{
    titolo:'Reg. (UE) 2024/1781 ‚Äì ESPR & Digital Product Passport',
    perche:'DMS traccia sostenibilit√† prodotti via passaporto digitale integrato.',
    articoli:[ {art:'art. 9', focus:'passaporto digitale prodotto'}, {art:'art. 15', focus:'tracciabilit√† supply chain'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32024R1781'
  },
  bolkestein_2006_123:{
    titolo:'Direttiva 2006/123/CE ‚Äì "Bolkestein"',
    perche:'DMS semplifica procedure per libera prestazione servizi nel mercato interno.',
    articoli:[ {art:'art. 8', focus:'sportello unico'}, {art:'art. 13', focus:'procedure semplificate'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32006L0123'
  },
  dogane_2023_258:{
    titolo:'Riforma Dogane UE (pacchetto COM(2023) 258‚Äì260)',
    perche:'DMS facilita adempimenti doganali digitali e interoperabilit√† con sistemi UE.',
    articoli:[ {art:'digitalizzazione', focus:'procedure doganali paperless'}, {art:'interoperabilit√†', focus:'sistemi informativi integrati'} ],
    pdf:'https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=COM%3A2023%3A258%3AFIN'
  },
  pnrr_italia:{
    titolo:'PNRR ‚Äì Italia Domani',
    perche:'DMS contribuisce a digitalizzazione PA e transizione ecologica previste dal Piano.',
    articoli:[ {art:'M1C1', focus:'digitalizzazione PA'}, {art:'M2C2', focus:'economia circolare'} ],
    pdf:'https://www.governo.it/sites/governo.it/files/PNRR.pdf'
  },
  pdnd_dati:{
    titolo:'PDND ‚Äì Piattaforma Digitale Nazionale Dati',
    perche:'DMS si integra con PDND per condivisione sicura dati tra amministrazioni.',
    articoli:[ {art:'interoperabilit√†', focus:'API standardizzate'}, {art:'once-only', focus:'riuso dati certificati'} ],
    pdf:'https://docs.italia.it/italia/piano-triennale-ict/pianotriennale-ict-doc/it/2021-2023/capitolo-5-interoperabilita.html'
  },
  agid_interop:{
    titolo:'AgID ‚Äì Linee guida interoperabilit√†',
    perche:'DMS implementa standard AgID per interoperabilit√† tecnica e semantica.',
    articoli:[ {art:'ModI', focus:'pattern interazione'}, {art:'API Gateway', focus:'gestione API'} ],
    pdf:'https://docs.italia.it/italia/piano-triennale-ict/lg-modellointeroperabilita/it/bozza/index.html'
  }
};

<script>
// === Mappa PDF ufficiali per ogni norma (fonti: EUR-Lex, Normattiva, Docs Italia, Governo) ===
const PDF = {
  sdg_2018_1724:               'https://eur-lex.europa.eu/eli/reg/2018/1724/oj',
  interoperable_europe_2024_903:'https://eur-lex.europa.eu/eli/reg/2024/903/oj',
  eidas2_2024_1183:            'https://eur-lex.europa.eu/eli/reg/2024/1183/oj',
  espr_dpp_2024_1781:          'https://eur-lex.europa.eu/eli/reg/2024/1781/oj',
  bolkestein_2006_123:         'https://eur-lex.europa.eu/eli/dir/2006/123/oj',
  dpr160_2010:                 'https://www.normattiva.it/uri-res/N2Ls?urn:nir:presidente.repubblica:decreto:2010-09-07;160',
  dogane_com_2023_258_260:     'https://eur-lex.europa.eu/search.html?text=COM(2023)%20258%20259%20260%20customs',
  pnrr_italiadomani:           'https://www.governo.it/sites/governo.it/files/PNRR_Italia_Domani.pdf',
  pdnd:                        'https://docs.italia.it/italia/piano-triennale-ict/dati-di-qualita-docs/it/bozza/index.html',
  agid_linee_interop:          'https://docs.italia.it/agid/interoperabilita-tecnica/lg-modellointeroperabilita-docs/it/stabile/_downloads/pdf/lg-modellointeroperabilita-docs.pdf',
  siconbep_106_2023:           'https://www.rgs.mef.gov.it/siconbep/'
};

// Applica la mappa PDF all'oggetto NORME esistente (idempotente)
if (typeof NORME === 'object' && NORME) {
  Object.entries(PDF).forEach(([id, url]) => {
    if (!NORME[id]) NORME[id] = {};
    NORME[id].pdf = url;
  });
}
</script>


  const d = NORME[id];
  if(!SCHEDA) return;
  if(!d){
    SCHEDA.classList.remove('norma-empty');
    SCHEDA.innerHTML = '<p>Norma non trovata.</p>';
    SCHEDA.removeAttribute('hidden');
    return;
  }
  const articoliHTML = (d.articoli||[]).map(a=>`<li><b>${a.art}</b>: ${a.focus}</li>`).join('');
  SCHEDA.classList.remove('norma-empty');
  SCHEDA.innerHTML = `
    <h3>${d.titolo}</h3>
    <p class="muted">${d.perche}</p>
    <div class="arts">
      <b>Articoli/commi rilevanti:</b>
      <ul style="margin:6px 0 0 16px">${articoliHTML}</ul>
    </div>
    <a class="btn" href="${d.pdf}" target="_blank" rel="noopener">üìÑ Testo integrale (PDF)</a>
  `;
  SCHEDA.removeAttribute('hidden');
  // porta in vista su iPad
  SCHEDA.scrollIntoView({behavior:'smooth', block:'nearest'});
}

document.addEventListener('click', (e)=>{
  if(!btn) return;
  // se √® un <a>, evita il reload
  if(btn.tagName === 'A') e.preventDefault();
});

// (opz.) Test rapido da URL: ?open=dpr160_2010
(function(){
  const v = new URL(location).searchParams.get('open');
})();

// (opz.) Esporta la funzione per test manuale da console
</script>

<script>
// Sorgente unica dei contenuti per modal + SPOT
window.DOC_MAP = {
  agid:   { title:'AgID',   images:['img/ministeri/agid-01.jpg'], pdfs:[
    {label:'A4',   url:'/dms-gemello-news/docs/agid/a4.pdf'},
    {label:'PDF 1',url:'/dms-gemello-news/docs/agid/doc1.pdf'}
  ]},
  ae:     { title:'AE - Agenzia Entrate', images:['img/ministeri/ae-01.jpg'], pdfs:[] },
  mef:    { title:'MEF - Min. Economia e Finanze', images:['img/ministeri/mef-01.jpg','img/ministeri/mef-02.jpg','img/ministeri/mef-03.jpg'], pdfs:[
    {label:'Scheda 1', url:'/dms-gemello-news/assets/doc/MEF/MEF-scheda-1.pdf'},
    {label:'Scheda 2', url:'/dms-gemello-news/assets/doc/MEF/MEF-scheda-2.pdf'},
    {label:'Scheda 3', url:'/dms-gemello-news/assets/doc/MEF/MEF-scheda-3.pdf'},
    {label:'Scheda 4', url:'/dms-gemello-news/assets/doc/MEF/MEF-scheda-4.pdf'}
  ]},
  salute: { title:'Min. della Salute', images:['img/ministeri/salute-01.jpg','img/ministeri/salute-02.jpg'], pdfs:[
    {label:'Scheda A', url:'/dms-gemello-news/assets/doc/salute/salute-scheda-a.pdf'},
    {label:'Scheda B', url:'/dms-gemello-news/assets/doc/salute/salute-scheda-b.pdf'}
  ]},
  mit:    { title:'MIT - Min. Infrastrutture e Trasporti', images:['img/ministeri/mit-01.jpg'], pdfs:[] },
  pagopa: { title:'PagoPA', images:['img/ministeri/pagopa-01.jpg'], pdfs:[] },
  pcm:    { title:'PCM - Presidenza Consiglio Ministri', images:['img/ministeri/pcm-01.jpg','img/ministeri/pcm-02.jpg','img/ministeri/pcm-03.jpg'], pdfs:[
    {label:'Scheda 1', url:'/dms-gemello-news/assets/doc/PCM/PCM-scheda-1.pdf'},
    {label:'Scheda 2', url:'/dms-gemello-news/assets/doc/PCM/PCM-scheda-2.pdf'},
    {label:'Scheda 3', url:'/dms-gemello-news/assets/doc/PCM/PCM-scheda-3.pdf'}
  ]}
};
</script>

<script>
// === PATCH ULTRA-SEMPLICE ===

// === 0) copia il COLORE esatto dei bottoni PDF ===
(function(){
  // selettore di un bottone PDF gi√† presente nella colonna sinistra
  const pdfBtn = document.querySelector('.spot .doc-list a, .spot .btn-pdf, .doc-card a, .panel a[href$=".pdf"]');
  if (pdfBtn){
    const s = getComputedStyle(pdfBtn);
    document.documentElement.style.setProperty('--chip-bg', s.backgroundColor);
    document.documentElement.style.setProperty('--chip-text', s.color);
  }
})();

// === 1) disattiva qualunque anteprima inline/iframe ===
const preview = document.getElementById('doc-preview');
if (preview){ preview.style.display='none'; }

// forza sempre nuova tab (anche su PDF della lista)
document.querySelectorAll('#riferimenti-normativi a, .spot a[href$=".pdf"]').forEach(a=>{
  a.setAttribute('target','_blank'); a.setAttribute('rel','noopener');
  a.addEventListener('click', (e)=>{
    // lascia il default del browser: evita preventDefault (alcuni popup blocker bloccano window.open)
    e.stopPropagation();
  }, {passive:true});
});

// === 2) scroll affidabile alla sezione quando arrivo dalla mappa ===
(function(){
  const hash = window.location.hash;
  if (hash === '#riferimenti-normativi' || hash === '#norme') {
    setTimeout(()=>{
      (document.getElementById('goto-norme') || document.getElementById('riferimenti-normativi'))
        ?.scrollIntoView({behavior:'instant', block:'start'});
    },0);
  }
})();

// === 3) evidenzia SOLO le norme pertinenti al ministero (bordo ciano) ===
const NORMA_MAP = {
  'MEF':['sdg','interop','pdnd','pnrr'],
  'MIMIT':['espr','eidas2','bolk','interop'],
  'ADM':['dogane','pdnd','sdg'],
  'AE':['pdnd','pnrr','sdg'],
  'MIT':['sdg','pnrr','suap'],
  'Interno':['sdg','pdnd'],
  'Salute':['pdnd','eidas2','interop'],
  'Turismo':['sdg','pnrr'],
  'MASAF':['pnrr','pdnd'],
  'MASE':['pnrr','espr'],
  'MIC':['sdg','pnrr'],
  'MIM':['pnrr','pdnd'],
  'MAECI':['interop','eidas2'],
  'AgID':['interop','pdnd'],
  'PagoPA':['sdg','pnrr','pdnd']
};

(function(){
  const q = new URLSearchParams(location.search);
  const min = q.get('min');             // es. ?min=MEF
  const set = new Set(NORMA_MAP[min] || []);
  document.querySelectorAll('#riferimenti-normativi .norma-chip').forEach(el=>{
    el.classList.toggle('is-active', set.has(el.dataset.norm));
  });
})();
</script>

<script>
(function(){
  // ============ 0) CSS di sicurezza, nel caso mancasse ============
  var css = `
  :root{--focus-blue:#2A8CFF}
  .norma-empty{display:flex;align-items:center;justify-content:center;min-height:140px;font-weight:700;color:#6b7d72}
  @keyframes hotPing{0%{box-shadow:0 0 0 0 rgba(42,140,255,.65)}60%{box-shadow:0 0 0 12px rgba(42,140,255,0)}100%{box-shadow:0 0 0 0 rgba(42,140,255,0)}}
  `;
  var st = document.createElement('style'); st.textContent = css; document.head.appendChild(st);

  // ============ 1) Assicura che la scheda esista ============
  if(!card){
    card = document.createElement('section');
    card.textContent = 'Seleziona una norma per vedere articoli/commi e PDF ufficiale.';
    (anchor && anchor.parentElement ? anchor.parentElement : document.body).insertAdjacentElement('afterend', card);
  }

    var d = (window.NORME && window.NORME[id]) || null;
    var titolo = d?.titolo || (tEl?.textContent?.trim() || id);
    var perche = d?.perche || 'Scheda tecnica in caricamento.';
    var arts = (d?.articoli || []);
    var pdf = d?.pdf || (tEl?.dataset.pdf || '#');
    var li = arts.length ? arts.map(a=>`<li><b>${a.art}</b>: ${a.focus||''}</li>`).join('') : '<li>(in aggiornamento)</li>';
    card.classList.remove('norma-empty');
    card.innerHTML = `
      <h3>${titolo}</h3>
      <p class="muted">${perche}</p>
      <div class="arts"><b>Articoli/commi:</b><ul style="margin:6px 0 0 16px">${li}</ul></div>
      <a class="btn" href="${pdf}" target="_blank" rel="noopener">üìÑ PDF ufficiale</a>
    `;
    card.scrollIntoView({behavior:'smooth', block:'nearest'});
  };

  // ============ 3) Bind iPad-safe ai tasti (capture + touchstart) ============
  function bind(el){
    // Se √® <a>, neutralizza per evitare salti
    if(el.tagName==='A'){ el.setAttribute('href','javascript:void(0)'); el.removeAttribute('target'); el.setAttribute('rel','noopener'); }
    var handler = function(e){
      e.preventDefault(); e.stopPropagation();
      el.classList.add('is-hot');
    };
    el.addEventListener('touchstart', handler, {passive:false, capture:true}); // prima del click su iPad
    el.addEventListener('click', handler, true); // in capture-phase
  }

  // ============ 4) Parametri URL (compatibile col tuo impianto) ============
  var q = new URL(location).searchParams;

  // ============ 5) Diag opzionale: ?diag=1 mostra box di prova ============
  if(q.get('diag')==='1'){
    var box=document.createElement('div');
    box.style.cssText='position:fixed;left:10px;bottom:10px;z-index:9999;background:#111;color:#fff;border:1px solid #3a3a3a;border-radius:10px;padding:8px 10px;font:600 12px system-ui';
    var nCount=(window.NORME?Object.keys(window.NORME).length:0);
    box.innerHTML=`Diag: tasti=${count} ‚Ä¢ scheda=${!!card} ‚Ä¢ dataset=${nCount}<br><button id="__probe" style="margin-top:6px">Apri prova (DPR160)</button>`;
    document.body.appendChild(box);
  }
})();
</script>

<script>
(function(){
  // --- CSS di ripristino (forza visibilit√† scheda, zero conflitti) ---
  const css = `
  :root{--focus-blue:#2A8CFF}
  .muted{color:#4b5a52}
  .arts{border-left:3px solid var(--focus-blue);padding-left:10px;margin:10px 0}
  .btn-pdf{display:inline-flex;gap:8px;padding:8px 12px;border:1px solid var(--focus-blue);border-radius:10px;text-decoration:none;font-weight:800}
  @keyframes hotPing{0%{box-shadow:0 0 0 0 rgba(42,140,255,.65)}60%{box-shadow:0 0 0 12px rgba(42,140,255,0)}100%{box-shadow:0 0 0 0 rgba(42,140,255,0)}}
  `;
  const st=document.createElement('style'); st.textContent=css; document.head.appendChild(st);

  // --- 1) Assicura che la scheda esista proprio sotto i tasti ---
  if(!card){
    card = document.createElement('section');
    grid.insertAdjacentElement('afterend', card);
  }
  // Rimuovi eventuali classi che la nascondono
  ['hidden','is-hidden','d-none'].forEach(c=>card.classList.remove(c));
  card.removeAttribute('hidden'); card.style.visibility='visible';

    const d = (window.NORME && window.NORME[id]) || null;
    // Fallback: usa il testo del bottone se il dataset non c'√®
    const titolo = d?.titolo || d?.t || (btn?.textContent?.trim() || id);
    const perche = d?.perche || d?.p || 'Sintesi normativa.';
    const art = (d?.articoli || d?.a || []).map(a=>typeof a==='string'?a:`${a.art}${a.focus?(' ‚Äî '+a.focus):''}`);
    const pdf = d?.pdf || btn?.dataset.pdf || '#';
    card.innerHTML = `
      <h3>${titolo}</h3>
      <p class="muted">${perche}</p>
      <div class="arts"><b>Articoli/commi rilevanti:</b>
        <ul style="margin:6px 0 0 16px">${(art.length?art:['(in aggiornamento)']).map(x=>`<li>${x}</li>`).join('')}</ul>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn-pdf" href="${pdf}" target="_blank" rel="noopener">üìÑ Testo integrale (PDF)</a>
        <!-- Se volete mantenere le copertine PDF in rosso, legate QUI il vostro handler esistente -->
        <button type="button" class="btn-pdf" onclick="window.showPdfCover?.('${id}')">üñºÔ∏è Copertina PDF</button>
      </div>
    `;
    card.scrollIntoView({behavior:'smooth', block:'nearest'});
  };

  // --- 3) iPad-safe: blocca navigazione/submit PRIMA che Safari agisca ---
  function activate(e){
    if(!t) return;
    if(e.cancelable!==false) e.preventDefault();
    e.stopPropagation(); if(t.tagName==='A'){ t.href='javascript:void(0)'; t.removeAttribute('target'); }
    if(t.tagName==='BUTTON' && t.type!=='button'){ t.type='button'; }
    t.classList.add('is-hot');
  }
  ['touchstart','click'].forEach(evt=>document.addEventListener(evt, activate, {passive:false, capture:true}));

  // --- 4) Supporto parametri (test facile) ---
  const q=new URL(location).searchParams;
})();
</script>

<style>
  /* KILL SWITCH: la scheda DEVE essere visibile */
    display:block !important;
    visibility:visible !important;
    opacity:1 !important;
    height:auto !important;
  }
</style>
<script>
(function(){
  if(!WRAP||!GRID||!CARD) return;

  // Dataset: usa globale se presente, altrimenti fallback
  const N = window.NORME || {
    sdg_2018_1724:{t:'Reg. (UE) 2018/1724 ‚Äî Single Digital Gateway',p:'Once-only via PDND.',a:['riuso dati'],pdf:'https://eur-lex.europa.eu/eli/reg/2018/1724/oj'},
    interoperable_europe_2024_903:{t:'Reg. (UE) 2024/903 ‚Äî Interoperable Europe',p:'Interoperabilit√† UE.',a:['cooperazione, standard'],pdf:'https://eur-lex.europa.eu/eli/reg/2024/903/oj'},
    eidas2_2024_1183:{t:'Reg. (UE) 2024/1183 ‚Äî eIDAS 2',p:'Identit√† e firme.',a:['wallet, sigilli'],pdf:'https://eur-lex.europa.eu/eli/reg/2024/1183/oj'},
    espr_dpp_2024_1781:{t:'Reg. (UE) 2024/1781 ‚Äî ESPR & DPP',p:'Eco-design e DPP.',a:['tracciabilit√†'],pdf:'https://eur-lex.europa.eu/eli/reg/2024/1781/oj'},
    bolkestein_2006_123:{t:'Dir. 2006/123/CE ‚Äî Servizi',p:'Trasparenza e concorrenza.',a:['criteri oggettivi'],pdf:'https://eur-lex.europa.eu/eli/dir/2006/123/oj'},
    dpr160_2010:{t:'DPR 160/2010 ‚Äî SUAP',p:'SCIA/endo-pareri; interoperabilit√†.',a:['art.5 telematica','art.10 endo-pareri'],pdf:'https://www.normattiva.it/uri-res/N2Ls?urn:nir:presidente.repubblica:decreto:2010-09-07;160'},
    dogane_com_2023_258_260:{t:'Riforma Dogane UE ‚Äî COM(2023) 258‚Äì260',p:'Controlli risk-based.',a:['semplificazioni'],pdf:'https://eur-lex.europa.eu/search.html?text=COM(2023)%20258%20259%20260%20customs'},
    pnrr_italiadomani:{t:'PNRR ‚Äî Italia Domani',p:'Digitalizzazione e interoperabilit√†.',a:['M1C1'],pdf:'https://www.governo.it/sites/governo.it/files/PNRR_Italia_Domani.pdf'},
    pdnd:{t:'PDND ‚Äî Piattaforma Dati',p:'Once-only tra PA.',a:['catalogo/accordi'],pdf:'https://docs.italia.it/italia/piano-triennale-ict/dati-di-qualita-docs/it/bozza/index.html'},
    agid_linee_interop:{t:'AgID ‚Äî Linee guida interoperabilit√†',p:'API/semantica/sicurezza.',a:['modelli dati'],pdf:'https://docs.italia.it/agid/interoperabilita-tecnica/lg-modellointeroperabilita-docs/it/stabile/_downloads/pdf/lg-modellointeroperabilita-docs.pdf'},
    siconbep_106_2023:{t:'D.Lgs. 106/2023 ‚Äî SICONBEP',p:'Flussi concessioni/posteggi.',a:['monitoraggio'],pdf:'https://www.rgs.mef.gov.it/siconbep/'}
  };

    const d=N[id]; if(!d) return;
    const li=(d.a||[]).map(x=>`<li>${x}</li>`).join('')||'<li>(in aggiornamento)</li>';
    const pGU=d.gu||d.pdf, pEU=d.eurlex && d.eurlex!==pGU ? d.eurlex : null;
    CARD.innerHTML=`
      <h3>${d.t}</h3><p class="muted">${d.p||''}</p>
      <div class="arts"><b>Articoli/commi rilevanti:</b><ul style="margin:6px 0 0 16px">${li}</ul></div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        ${pGU?`<a class="btn" href="${pGU}" target="_blank" rel="noopener">üìÑ Gazzetta/Normattiva</a>`:''}
        ${pEU?`<a class="btn" href="${pEU}" target="_blank" rel="noopener">üìò EUR-Lex</a>`:''}
      </div>`;
    CARD.scrollIntoView({behavior:'smooth',block:'nearest'});
  }

  // Delegazione SOLO dentro la griglia (nessun impatto su altri link/video)
  function onTap(e){
    if(!btn || !GRID.contains(btn)) return;
    if(e.cancelable!==false) e.preventDefault(); e.stopPropagation();
  }
  GRID.addEventListener('touchstart',onTap,{passive:false,capture:true});
  GRID.addEventListener('click',onTap,true);

  // Parametri URL & ministro
    if(!min) return;
      b.classList.toggle('is-relevant', owns.includes(min));
    });
  }
  const q=new URL(location).searchParams;
})();
</script>

</body>
</html>

